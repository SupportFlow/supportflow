/*! SupportFlow minified version */
jQuery(document).ready(function(a){a(".toggle-link").click(function(b){var c=a(this).siblings(".toggle-content").css("display");a(".toggle-content").hide(500),a(".toggle-link").prop("title",SFToggleLinks.expand),"none"==c&&(a(this).siblings(".toggle-content").show(500),a(this).prop("title",SFToggleLinks.collapse)),b.preventDefault()}),a(a(".toggle-content")).each(function(){"none"==a(this).css("display")?a(this).siblings(".toggle-link").prop("title",SFToggleLinks.expand):a(this).siblings(".toggle-link").prop("title",SFToggleLinks.collapse),a(".toggle-content").first().show(500)})}),jQuery(document).ready(function(a){a(".delete_email_account").click(function(b){if(b.preventDefault(),confirm(SFEmailAccounts.sure_delete_account)){var c=a(this).data("account-id"),d="edit.php?post_type="+SFEmailAccounts.post_type+"&page="+SFEmailAccounts.slug,e="";e+='<form method="POST" id="remove_email_account" action="'+d+'">',e+='<input type="hidden" name="action" value="delete" />',e+=SFEmailAccounts.delete_email_account_nonce,e+='<input type="hidden" name="account_id" value='+c+" />",e+="</form>",a("body").append(e),a("#remove_email_account").submit()}}),a("#add_new_email_account #imap_ssl").change(function(){this.checked?a("#add_new_email_account #imap_port").val("993"):a("#add_new_email_account #imap_port").val("143")}),a("#add_new_email_account #smtp_ssl").change(function(){this.checked?a("#add_new_email_account #smtp_port").val("465"):a("#add_new_email_account #smtp_port").val("25")})}),jQuery(document).ready(function(a){var b=function(b){b.preventDefault();var c=a("#email_conversation_to").val();a.ajax(ajaxurl,{type:"post",data:{action:"sf_forward_conversation",email_ids:c,post_id:SFEmailConversation.post_id,_email_conversation_nonce:SFEmailConversation._email_conversation_nonce},beforeSend:function(){a("#email_conversation_to").prop("disabled",!0),a("#email_conversation_submit").prop("disabled",!0),a("#email_conversation_status").text(SFEmailConversation.sending_emails)},success:function(b){a("#email_conversation_status").html(b)},error:function(){a("#email_conversation_status").text(SFEmailConversation.failed_sending)},complete:function(){a("#email_conversation_to").prop("disabled",!1),a("#email_conversation_submit").prop("disabled",!1)}})};a("#email_conversation_submit").click(b),a("#email_conversation_to").keyup(function(){(10==event.keyCode||13==event.keyCode)&&b()})}),jQuery(document).ready(function(a){a(".permission_filters").change(function(){var b=a("#change_user option:selected").data("user-id"),c=a("#change_status option:selected").data("status");a.ajax(ajaxurl,{type:"post",data:{action:"get_user_permissions",user_id:b,status:c,_get_user_permissions_nonce:SFPermissions._get_user_permissions_nonce},success:function(b){a("#user_permissions_table").html(b)}})}),a(document).on("change",".sf_user_permissions_table .toggle_privilege",function(){var b=a(this),c=b.siblings(".privilege_status"),d=b.data("permission-identifier"),e=b.prop("checked"),f=d.user_id,g=d.privilege_type,h=d.privilege_id;c.html(SFPermissions.changing_status),b.prop("disabled",!0),a.ajax(ajaxurl,{type:"post",data:{action:"set_user_permission",user_id:f,privilege_type:g,privilege_id:h,allowed:e,_set_user_permission_nonce:SFPermissions._set_user_permission_nonce},success:function(a){1!=a&&(b.prop("checked",!b.prop("checked")),alert(SFPermissions.failed_changing_status))},error:function(){b.prop("checked",!b.prop("checked")),alert(SFPermissions.failed_changing_status)},complete:function(){var a=b.prop("checked");1==a?c.html(SFPermissions.allowed):c.html(SFPermissions.not_allowed),b.prop("disabled",!1)}})})}),jQuery(document).ready(function(a){a("#predefs").change(function(){if(void 0==this.old_child&&(this.old_child=1),new_content=a("#predefs").find("option:selected").data("content"),old_content=a(".predef:nth-child("+this.old_child+")").data("content"),current_content=a("#reply").val(),0!=new_content.length){if(current_content!=old_content&&0==window.confirm(SFPredefinedReplies.message))return void a(".predef:nth-child("+this.old_child+")").prop("selected",!0);a("#reply").val(new_content),this.old_child=a("#predefs").find("option:selected").index()+1}})}),jQuery(document).ready(function(a){a(document).on("change",".sf_email_accounts_table .toggle_privilege",function(){var b=a(this),c=b.siblings(".privilege_status"),d=b.data("email-notfication-identifier"),e=b.prop("checked"),f=d.privilege_type,g=d.privilege_id;c.html(SFPreferences.changing_state),b.prop("disabled",!0),a.ajax(ajaxurl,{type:"post",data:{action:"set_email_notfication",privilege_type:f,privilege_id:g,allowed:e,_set_email_notfication_nonce:SFPreferences.set_email_notfication_nonce},success:function(a){1!=a&&(b.prop("checked",!b.prop("checked")),alert(SFPreferences.failed_changing_state))},error:function(){b.prop("checked",!b.prop("checked")),alert(SFPreferences.failed_changing_state)},complete:function(){var a=b.prop("checked");1==a?c.html(SFPreferences.subscribed):c.html(SFPreferences.unsubscribed),b.prop("disabled",!1)}})})}),jQuery(document).ready(function(a){if("sf_ticket"==pagenow){var b=function(){var b=a("#customers").val().replace(" ","").split(",");if(a.isArray(b)&&b.length>1)var c=b.pop();else c=b[0];return{customers:c,"api-action":"get-customers"}};a("#customers").autocomplete({source:function(c,d){a.ajax({url:SFCustomersAc.ajax_url,dataType:"json",data:b(),success:function(b){return""==b.query?(d(!1),!1):void d(a.map(b.customers,function(b){var c=a("#customers").val().split(" ").join("").split(",");if(c.pop(),-1==a.inArray(b.name,c)){c.push(b.name);var d=c.join(", ")+", ";return{label:b.name,value:d}}}))}})},minLength:2})}}),jQuery(document).ready(function(a){attachment_uploader={init:function(){a(document).on("click","#reply-attachment-browse-button",{},attachment_uploader.uploader),a(document).on("click",".reply-attachment-remove",attachment_uploader.remove)},uploader:function(b){var c=wp.media({title:SFTicketAttachments.frame_title,multiple:!0,button:{text:SFTicketAttachments.button_title}});return c.on("close",function(){var b=c.state().get("selection").toJSON();a.each(b,function(){var b='<a class="reply-attachment-link" target="_blank" href="'+_.escape(this.url)+'">'+_.escape(this.filename)+"</a>",c='<a class="reply-attachment-remove delete" href="#" data-attachment-id='+_.escape(this.id)+" >"+SFTicketAttachments.remove_attachment+"</a>";a("#replies-attachments-list").append('<li id="media-items" class="reply-attachment">'+b+"&nbsp;"+c+"</li>"),a("#reply-attachments").val(a("#reply-attachments").val()+_.escape(this.id)+",")})}),c.open(),!1},remove:function(b){if(confirm(SFTicketAttachments.sure_remove)){var c=a(this).data("attachment-id"),d=a("#reply-attachments").val();d=d.replace(","+c+",",","),a("#reply-attachments").val(d),a(this).closest(".reply-attachment").remove()}b.preventDefault()}},attachment_uploader.init()}),jQuery(document).ready(function(a){a("#supportflow-details .meta-item-ok-button").click(function(b){var c=a(this).siblings(".meta-item-dropdown").children("option:selected"),d=a(this).closest(".meta-item"),e=d.children(".meta-item-name"),f=d.children(".meta-item-label");e.val(c.val()),f.text(c.text()),b.preventDefault()}),a("#supportflow-details .meta-item-toggle-button").click(function(b){a(this).closest(".meta-item").children(".meta-item-toggle-content").toggle(250),b.preventDefault()}),a(".save-button").click(function(b){return""==a("#subject").val()?(a("#subject").focus(),alert(SFTickets.no_title_msg),void b.preventDefault()):""==a("#customers").val()?(a("#customers").focus(),alert(SFTickets.no_customer_msg),void b.preventDefault()):void 0}),a("#reply").keypress(function(b){!b.ctrlKey||10!=b.keyCode&&13!=b.keyCode||""==a(this).val()||a(".save-button").first().click()}),a("#mark-private").change(function(){"post.php"==SFTickets.pagenow&&(a("#mark-private").prop("checked")?a("#insert-reply").val(SFTickets.add_private_note):a("#insert-reply").val(SFTickets.send_msg))}),a("#close-ticket-submit").click(function(b){a("#post .meta-item input[name='post_status']").val("sf_closed")}),a(".sf_toggle_quoted_text").click(function(b){b.preventDefault(),a(this).parent().html(a(this).data("quoted_text"))})}),jQuery(document).ready(function(a){a(".sf_autosave").keyup(function(){var b={};b.ticket_id=SFAutoSave.ticket_id,a(".sf_autosave").each(function(){element_key=a(this).attr("name"),element_value=a(this).val(),b[element_key]=element_value}),wp.heartbeat.enqueue("supportflow-autosave",b,!1)})});