/*! SupportFlow minified version */
jQuery(document).ready(function(){jQuery(".toggle-link").click(function(a){var b=jQuery(this).siblings(".toggle-content").css("display");jQuery(".toggle-content").hide(500),jQuery(".toggle-link").prop("title",SFToggleLinks.expand),"none"==b&&(jQuery(this).siblings(".toggle-content").show(500),jQuery(this).prop("title",SFToggleLinks.collapse)),a.preventDefault()}),jQuery(jQuery(".toggle-content")).each(function(){"none"==jQuery(this).css("display")?jQuery(this).siblings(".toggle-link").prop("title",SFToggleLinks.expand):jQuery(this).siblings(".toggle-link").prop("title",SFToggleLinks.collapse),jQuery(".toggle-content").first().show(500)})}),jQuery(document).ready(function(){jQuery(".delete_email_account").click(function(a){if(a.preventDefault(),confirm(SFEmailAccounts.sure_delete_account)){var b=jQuery(this).data("account-id"),c="edit.php?post_type="+SFEmailAccounts.post_type+"&page="+SFEmailAccounts.slug,d="";d+='<form method="POST" id="remove_email_account" action="'+c+'">',d+='<input type="hidden" name="action" value="delete" />',d+=SFEmailAccounts.delete_email_account_nonce,d+='<input type="hidden" name="account_id" value='+b+" />",d+="</form>",jQuery("body").append(d),jQuery("#remove_email_account").submit()}}),jQuery("#add_new_email_account #imap_ssl").change(function(){jQuery("#add_new_email_account #imap_port").val(this.checked?"993":"143")}),jQuery("#add_new_email_account #smtp_ssl").change(function(){jQuery("#add_new_email_account #smtp_port").val(this.checked?"465":"25")})}),jQuery(document).ready(function(){var a=function(a){a.preventDefault();var b=jQuery("#email_conversation_to").val();jQuery.ajax(ajaxurl,{type:"post",data:{action:"sf_forward_conversation",email_ids:b,post_id:SFEmailConversation.post_id,_email_conversation_nonce:SFEmailConversation._email_conversation_nonce},beforeSend:function(){jQuery("#email_conversation_to").prop("disabled",!0),jQuery("#email_conversation_submit").prop("disabled",!0),jQuery("#email_conversation_status").text(SFEmailConversation.sending_emails)},success:function(a){jQuery("#email_conversation_status").html(a)},error:function(){jQuery("#email_conversation_status").text(SFEmailConversation.failed_sending)},complete:function(){jQuery("#email_conversation_to").prop("disabled",!1),jQuery("#email_conversation_submit").prop("disabled",!1)}})};jQuery("#email_conversation_submit").click(a),jQuery("#email_conversation_to").keyup(function(){10==event.keyCode&&a()})}),jQuery(document).ready(function(){jQuery(".permission_filters").change(function(){var a=jQuery("#change_user option:selected").data("user-id"),b=jQuery("#change_status option:selected").data("status");jQuery.ajax(ajaxurl,{type:"post",data:{action:"get_user_permissions",user_id:a,status:b,_get_user_permissions_nonce:SFPermissions._get_user_permissions_nonce},success:function(a){jQuery("#user_permissions_table").html(a)}})}),jQuery(document).on("change",".sf_user_permissions_table .toggle_privilege",function(){var a=jQuery(this),b=a.siblings(".privilege_status"),c=a.data("permission-identifier"),d=a.prop("checked"),e=c.user_id,f=c.privilege_type,g=c.privilege_id;b.html(SFPermissions.changing_status),a.prop("disabled",!0),jQuery.ajax(ajaxurl,{type:"post",data:{action:"set_user_permission",user_id:e,privilege_type:f,privilege_id:g,allowed:d,_set_user_permission_nonce:SFPermissions._set_user_permission_nonce},success:function(b){1!=b&&(a.prop("checked",!a.prop("checked")),alert(SFPermissions.failed_changing_status))},error:function(){a.prop("checked",!a.prop("checked")),alert(SFPermissions.failed_changing_status)},complete:function(){var c=a.prop("checked");b.html(1==c?SFPermissions.allowed:SFPermissions.not_allowed),a.prop("disabled",!1)}})})}),jQuery(document).ready(function(){jQuery("#predefs").change(function(){if(void 0==this.old_child&&(this.old_child=1),new_content=jQuery("#predefs").find("option:selected").data("content"),old_content=jQuery(".predef:nth-child("+this.old_child+")").data("content"),current_content=jQuery("#reply").val(),0!=new_content.length){if(current_content!=old_content&&0==window.confirm(SFPredefinedReplies.message))return void jQuery(".predef:nth-child("+this.old_child+")").prop("selected",!0);jQuery("#reply").val(new_content),this.old_child=jQuery("#predefs").find("option:selected").index()+1}})}),jQuery(document).ready(function(){jQuery(document).on("change",".sf_email_accounts_table .toggle_privilege",function(){var a=jQuery(this),b=a.siblings(".privilege_status"),c=a.data("email-notfication-identifier"),d=a.prop("checked"),e=c.privilege_type,f=c.privilege_id;b.html(SFPreferences.changing_state),a.prop("disabled",!0),jQuery.ajax(ajaxurl,{type:"post",data:{action:"set_email_notfication",privilege_type:e,privilege_id:f,allowed:d,_set_email_notfication_nonce:SFPreferences.set_email_notfication_nonce},success:function(b){1!=b&&(a.prop("checked",!a.prop("checked")),alert(SFPreferences.failed_changing_state))},error:function(){a.prop("checked",!a.prop("checked")),alert(SFPreferences.failed_changing_state)},complete:function(){var c=a.prop("checked");b.html(1==c?SFPreferences.subscribed:SFPreferences.unsubscribed),a.prop("disabled",!1)}})})}),jQuery(document).ready(function(a){var b=function(){var b=a("#customers").val().replace(" ","").split(",");if(a.isArray(b)&&b.length>1)var c=b.pop();else c=b[0];return{customers:c,"api-action":"get-customers"}};a("#customers").autocomplete({source:function(c,d){a.ajax({url:SFCustomersAc.ajax_url,dataType:"json",data:b(),success:function(b){return""==b.query?(d(!1),!1):void d(a.map(b.customers,function(b){var c=a("#customers").val().split(" ").join("").split(",");if(c.pop(),-1==a.inArray(b.name,c)){c.push(b.name);var d=c.join(", ")+", ";return{label:b.name,value:d}}}))}})},minLength:2})}),jQuery(document).ready(function(a){attachment_uploader={init:function(){a(document).on("click","#reply-attachment-browse-button",{},attachment_uploader.uploader),a(document).on("click",".reply-attachment-remove",attachment_uploader.remove)},uploader:function(){var a=wp.media({title:SFTicketAttachments.frame_title,multiple:!0,button:{text:SFTicketAttachments.button_title}});return a.on("close",function(){var b=a.state().get("selection").toJSON();jQuery.each(b,function(){var a='<a class="reply-attachment-link" target="_blank" href="'+_.escape(this.url)+'">'+_.escape(this.filename)+"</a>",b='<a class="reply-attachment-remove delete" href="#" data-attachment-id='+_.escape(this.id)+" >"+SFTicketAttachments.remove_attachment+"</a>";jQuery("#replies-attachments-list").append('<li id="media-items" class="reply-attachment">'+a+"&nbsp;"+b+"</li>"),jQuery("#reply-attachments").val(jQuery("#reply-attachments").val()+_.escape(this.id)+",")})}),a.open(),!1},remove:function(b){if(confirm(SFTicketAttachments.sure_remove)){var c=a(this).data("attachment-id"),d=a("#reply-attachments").val();d=d.replace(","+c+",",","),a("#reply-attachments").val(d),a(this).closest(".reply-attachment").remove()}b.preventDefault()}},attachment_uploader.init()}),jQuery(document).ready(function(){jQuery("#supportflow-details .meta-item-ok-button").click(function(a){var b=jQuery(this).siblings(".meta-item-dropdown").children("option:selected"),c=jQuery(this).closest(".meta-item"),d=c.children(".meta-item-name"),e=c.children(".meta-item-label");d.val(b.val()),e.text(b.text()),a.preventDefault()}),jQuery("#supportflow-details .meta-item-toggle-button").click(function(a){jQuery(this).closest(".meta-item").children(".meta-item-toggle-content").toggle(250),a.preventDefault()}),jQuery(".save-button").click(function(a){return""==jQuery("#subject").val()?(jQuery("#subject").focus(),alert(SFTickets.no_title_msg),void a.preventDefault()):""==jQuery("#customers").val()?(jQuery("#customers").focus(),alert(SFTickets.no_customer_msg),void a.preventDefault()):void 0}),jQuery("#reply").keypress(function(a){a.ctrlKey&&10==a.keyCode&&""!=$(this).val()&&$("#post").submit()}),jQuery("#mark-private").change(function(){"post.php"==SFTickets.pagenow&&jQuery("#insert-reply").val(jQuery("#mark-private").prop("checked")?SFTickets.add_private_note:SFTickets.send_msg)}),jQuery("#close-ticket-submit").click(function(){jQuery("#post .meta-item input[name='post_status']").val("sf_closed")}),jQuery(".sf_toggle_quoted_text").click(function(a){a.preventDefault(),jQuery(this).parent().html(jQuery(this).data("quoted_text"))})}),jQuery(document).ready(function(){jQuery(".sf_autosave").keyup(function(){var a={};a.ticket_id=SFAutoSave.ticket_id,jQuery(".sf_autosave").each(function(){element_key=jQuery(this).attr("name"),element_value=jQuery(this).val(),a[element_key]=element_value}),wp.heartbeat.enqueue("supportflow-autosave",a,!1)})});